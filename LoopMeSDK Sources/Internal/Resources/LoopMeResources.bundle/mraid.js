!function(){LogLevelEnum={DEBUG:0,INFO:1,WARNING:2,ERROR:3};var e=LogLevelEnum.DEBUG,t={d:function(t){e<=LogLevelEnum.DEBUG&&console.log("(D) "+t)},i:function(t){e<=LogLevelEnum.INFO&&console.log("(I) "+t)},w:function(t){e<=LogLevelEnum.WARN&&console.log("(W) "+t)},e:function(e){console.log("(E) "+e)}},i=window.mraid={},r=i.STATES={LOADING:"loading",DEFAULT:"default",EXPANDED:"expanded",RESIZED:"resized",HIDDEN:"hidden"},n=i.PLACEMENT_TYPES={INLINE:"inline",INTERSTITIAL:"interstitial"},o=i.RESIZE_PROPERTIES_CUSTOM_CLOSE_POSITION={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",CENTER:"center",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"},s=i.ORIENTATION_PROPERTIES_FORCE_ORIENTATION={PORTRAIT:"portrait",LANDSCAPE:"landscape",NONE:"none"},a=i.EVENTS={ERROR:"error",READY:"ready",SIZECHANGE:"sizeChange",STATECHANGE:"stateChange",VIEWABLECHANGE:"viewableChange"},f=(i.SUPPORTED_FEATURES={SMS:"sms",TEL:"tel",CALENDAR:"calendar",STOREPICTURE:"storePicture",INLINEVIDEO:"inlineVideo"},r.LOADING),d=n.INLINE,h={},u=!1,l=!1,c={width:0,height:0,useCustomClose:!1,isModal:!0},E={allowOrientationChange:!0,forceOrientation:s.NONE},g={width:0,height:0,customClosePosition:o.TOP_RIGHT,offsetX:0,offsetY:0,allowOffscreen:!0},p={x:0,y:0,width:0,height:0},m={x:0,y:0,width:0,height:0},v={width:0,height:0},O={width:0,height:0},w={};i.addEventListener=function(e,r){if(t.i("mraid.addEventListener "+e+": "+String(r)),e&&r)if(S(e,a)){for(var n=w[e]=w[e]||[],o=0;o<n.length;o++){var s=String(r),f=String(n[o]);if(r===n[o]||s===f)return void t.i("listener "+s+" is already registered for event "+e)}n.push(r)}else i.fireErrorEvent("Unknown MRAID event: "+e,"addEventListener");else i.fireErrorEvent("Both event and listener are required.","addEventListener")},i.createCalendarEvent=function(e){t.i("mraid.createCalendarEvent with "+e),P("createCalendarEvent?eventJSON="+JSON.stringify(e))},i.close=function(){t.i("mraid.close"),P("close")},i.expand=function(e){void 0===e?t.i("mraid.expand (1-part)"):t.i("mraid.expand "+e),d!==n.INLINE||f!==r.DEFAULT&&f!==STAES.RESIZED||P(void 0===e?"expand":"expand?url="+encodeURIComponent(e))},i.getCurrentPosition=function(){return t.i("mraid.getCurrentPosition"),p},i.getDefaultPosition=function(){return t.i("mraid.getDefaultPosition"),m},i.getExpandProperties=function(){return t.i("mraid.getExpandProperties"),c},i.getStringExpandProperties=function(){return t.i("mraid.getStringExpandProperties"),JSON.stringify(c)},i.getMaxSize=function(){return t.i("mraid.getMaxSize "+v.width+" x "+v.height),v},i.getStringOrientationProperties=function(){return t.i("mraid.getOrientationProperties"),JSON.stringify(E)},i.getOrientationProperties=function(){return t.i("mraid.getOrientationProperties"),E},i.getPlacementType=function(){return t.i("mraid.getPlacementType"),d},i.getStringResizeProperties=function(){return t.i("mraid.getOrientationProperties"),JSON.stringify(g)},i.getResizeProperties=function(){return t.i("mraid.getResizeProperties"),g},i.getScreenSize=function(){return t.i("mraid.getScreenSize"),O},i.getState=function(){return t.i("mraid.getState"),f},i.getVersion=function(){return t.i("mraid.getVersion"),"2.0"},i.isViewable=function(){return t.i("mraid.isViewable"),u},i.open=function(e){t.i("mraid.open "+e),P("open?url="+encodeURIComponent(e))},i.playVideo=function(e){t.i("mraid.playVideo "+e),P("playVideo?url="+encodeURIComponent(e))},i.removeEventListener=function(e,r){if(t.i("mraid.removeEventListener "+e+" : "+String(r)),e)if(S(e,a))if(w.hasOwnProperty(e))if(r){for(var n=w[e],o=n.length,s=0;s<o;s++){var f=n[s],d=String(r),h=String(f);if(r===f||d===h){n.splice(s,1);break}}s===o&&t.i("listener "+d+" not found for event "+e),0===n.length&&delete w[e]}else delete w[e];else t.i("no listeners registered for event "+e);else i.fireErrorEvent("Unknown MRAID event: "+e,"removeEventListener");else i.fireErrorEvent("Event is required.","removeEventListener")},i.resize=function(){t.i("mraid.resize"),d!==n.INTERSTITIAL&&f!==r.LOADING&&f!==r.HIDDEN&&(f!==r.EXPANDED?l?P("resize"):i.fireErrorEvent("mraid.resize is not ready to be called","mraid.resize"):i.fireErrorEvent("mraid.resize called when ad is in expanded state","mraid.resize"))},i.setExpandProperties=function(e){if(t.i("mraid.setExpandProperties "+e),y(e,"setExpandProperties")){c.useCustomClose;for(var i=["width","height","useCustomClose"],r=0;r<i.length;r++){var n=i[r];e.hasOwnProperty(n)&&(c[n]=e[n])}}else t.e("failed validation")},i.setOrientationProperties=function(e){if(t.i("mraid.setOrientationProperties"),y(e,"setOrientationProperties")){var r={};r.allowOrientationChange=E.allowOrientationChange,r.forceOrientation=E.forceOrientation;for(var n=["allowOrientationChange","forceOrientation"],o=0;o<n.length;o++){var s=n[o];e.hasOwnProperty(s)&&(r[s]=e[s])}if(r.allowOrientationChange&&r.forceOrientation!==i.ORIENTATION_PROPERTIES_FORCE_ORIENTATION.NONE)i.fireErrorEvent("allowOrientationChange is true but forceOrientation is "+r.forceOrientation,"setOrientationProperties");else{E.allowOrientationChange=r.allowOrientationChange,E.forceOrientation=r.forceOrientation;var a="allowOrientationChange="+E.allowOrientationChange+"&forceOrientation="+E.forceOrientation;P("setOrientationProperties?"+a)}}else t.e("failed validation")},i.setResizeProperties=function(e){t.i("mraid.setResizeProperties"),l=!1;for(var r=["width","height","offsetX","offsetY"],n=0;n<r.length;n++){var o=r[n];if(!e.hasOwnProperty(o))return void i.fireErrorEvent("required property "+o+" is missing","mraid.setResizeProperties")}if(y(e,"setResizeProperties")){var s={x:0,y:0};if(e.hasOwnProperty("allowOffscreen")?e.allowOffscreen:g.allowOffscreen){if(!function(e){t.d("isCloseRegionOnScreen"),t.d("defaultPosition "+m.x+" "+m.y),t.d("offset "+e.offsetX+" "+e.offsetY);var i={};i.x=m.x+e.offsetX,i.y=m.y+e.offsetY,i.width=e.width,i.height=e.height,R("resizeRect",i);var r=e.hasOwnProperty("customClosePosition")?e.customClosePosition:g.customClosePosition;t.d("customClosePosition "+r);var n={width:50,height:50};-1!==r.search("left")?n.x=i.x:-1!==r.search("center")?n.x=i.x+i.width/2-25:-1!==r.search("right")&&(n.x=i.x+i.width-50);-1!==r.search("top")?n.y=i.y:"center"===r?n.y=i.y+i.height/2-25:-1!==r.search("bottom")&&(n.y=i.y+i.height-50);var o={x:0,y:0};return o.width=v.width,o.height=v.height,x(o,n)}(e))return void i.fireErrorEvent("close event region will not appear entirely onscreen","mraid.setResizeProperties")}else{if(e.width>v.width||e.height>v.height)return void i.fireErrorEvent("resize width or height is greater than the maxSize width or height","mraid.setResizeProperties");s=function(e){t.d("fitResizeViewOnScreen"),t.d("defaultPosition "+m.x+" "+m.y),t.d("offset "+e.offsetX+" "+e.offsetY);var i={};i.x=m.x+e.offsetX,i.y=m.y+e.offsetY,i.width=e.width,i.height=e.height,R("resizeRect",i);var r={x:0,y:0};r.width=v.width,r.height=v.height;var n={x:0,y:0};if(x(r,i))return t.d("no adjustment necessary"),n;i.x<r.x?n.x=r.x-i.x:i.x+i.width>r.x+r.width&&(n.x=r.x+r.width-(i.x+i.width));t.d("adjustments.x "+n.x),i.y<r.y?n.y=r.y-i.y:i.y+i.height>r.y+r.height&&(n.y=r.y+r.height-(i.y+i.height));return t.d("adjustments.y "+n.y),i.x=m.x+e.offsetX+n.x,i.y=m.y+e.offsetY+n.y,R("adjusted resizeRect",i),n}(e)}var a=["width","height","offsetX","offsetY","customClosePosition","allowOffscreen"];for(n=0;n<a.length;n++){o=a[n];e.hasOwnProperty(o)&&(g[o]=e[o])}var f="width="+g.width+"&height="+g.height+"&offsetX="+(g.offsetX+s.x)+"&offsetY="+(g.offsetY+s.y)+"&customClosePosition="+g.customClosePosition+"&allowOffscreen="+g.allowOffscreen;P("setResizeProperties?"+f),l=!0}else i.fireErrorEvent("failed validation","mraid.setResizeProperties")},i.storePicture=function(e){t.i("mraid.storePicture "+e),P("storePicture?url="+encodeURIComponent(e))},i.supports=function(e){t.i("mraid.supports "+e+" "+h[e]);var i=h[e];return void 0===i&&(i=!1),i},i.useCustomClose=function(e){t.i("mraid.useCustomClose "+e),c.useCustomClose=e,P("useCustomClose?useCustomClose="+e)},i.setCurrentPosition=function(e,r,n,o){t.i("mraid.setCurrentPosition "+e+","+r+","+n+","+o);var s={};s.width=p.width,s.height=p.height,t.i("previousSize "+s.width+","+s.height),p.x=e,p.y=r,p.width=n,p.height=o,n===s.width&&o===s.height||i.fireSizeChangeEvent(n,o)},i.setDefaultPosition=function(e,i,r,n){t.i("mraid.setDefaultPosition "+e+","+i+","+r+","+n),m.x=e,m.y=i,m.width=r,m.height=n},i.setExpandSize=function(e,i){t.i("mraid.setExpandSize "+e+"x"+i),c.width=e,c.height=i},i.setMaxSize=function(e,i){t.i("mraid.setMaxSize "+e+"x"+i),v.width=e,v.height=i},i.setPlacementType=function(e){t.i("mraid.setPlacementType "+e),d=e},i.setScreenSize=function(e,i){t.i("mraid.setScreenSize "+e+"x"+i),O.width=e,O.height=i},i.setSupports=function(e,i){t.i("mraid.setSupports "+e+" "+i),h[e]=i},i.fireErrorEvent=function(e,r){t.i("mraid.fireErrorEvent "+e+" "+r),C(i.EVENTS.ERROR,e,r)},i.fireReadyEvent=function(){t.i("mraid.fireReadyEvent"),C(i.EVENTS.READY)},i.fireSizeChangeEvent=function(e,r){t.i("mraid.fireSizeChangeEvent "+e+"x"+r),C(i.EVENTS.SIZECHANGE,e,r)},i.fireStateChangeEvent=function(e){t.i("mraid.fireStateChangeEvent "+e),f!==e&&(f=e,C(i.EVENTS.STATECHANGE,f))},i.fireViewableChangeEvent=function(e){t.i("mraid.fireViewableChangeEvent "+e),u!==e&&(u=e,C(i.EVENTS.VIEWABLECHANGE,u))},i.getStateString=function(){return f};var P=function(e){var t=document.createElement("IFRAME");t.setAttribute("src","mraid://"+e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},C=function(e){var i=Array.prototype.slice.call(arguments);i.shift(),t.i("fireEvent "+e+" ["+i.toString()+"]");var r={};if(w[e]&&w[e].length)for(var n=0;n<w[e].length;n++){r[o="i"+n]=w[e][n]}for(var o in r)r[o].apply(null,i)},S=function(e,t){for(var i in t)if(t[i]===e)return!0;return!1},y=function(e,t){var r=!0,n=N[t];for(var o in e){var s=n[o],a=e[o];s&&!s(a)&&(i.fireErrorEvent("Value of property "+o+" ("+a+") is invalid","mraid."+t),r=!1)}return r},N={setExpandProperties:{width:function(e){return!isNaN(e)},height:function(e){return!isNaN(e)},useCustomClose:function(e){return"boolean"==typeof e}},setOrientationProperties:{allowOrientationChange:function(e){return"boolean"==typeof e},forceOrientation:function(e){return-1!==["portrait","landscape","none"].indexOf(e)}},setResizeProperties:{width:function(e){return!isNaN(e)&&e>=50},height:function(e){return!isNaN(e)&&e>=50},offsetX:function(e){return!isNaN(e)},offsetY:function(e){return!isNaN(e)},customClosePosition:function(e){return-1!==["top-left","top-center","top-right","center","bottom-left","bottom-center","bottom-right"].indexOf(e)},allowOffscreen:function(e){return"boolean"==typeof e}}};function x(e,i){return t.d("isRectContained"),R("containingRect",e),R("containedRect",i),i.x>=e.x&&i.x+i.width<=e.x+e.width&&i.y>=e.y&&i.y+i.height<=e.y+e.height}function R(e,i){t.d(e+" ["+i.x+","+i.y+"],["+(i.x+i.width)+","+(i.y+i.height)+"] ("+i.width+"x"+i.height+")")}i.dumpListeners=function(){var e=Object.keys(w).length;for(var i in t.i("dumping listeners ("+e+" events)"),w){var r=w[i];t.i("  "+i+" contains "+r.length+" listeners");for(var n=0;n<r.length;n++)t.i("    "+r[n])}}}();
